

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head><title>
	
    
    Code Blog Foo: left-join-on-multiple-tables-in-linq-to-sql

</title><link href="../Content/base.css" rel="stylesheet" type="text/css" />
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    
    <script src="../../Scripts/shAll.js" type="text/javascript"></script>
    <link href="../../Content/SyntaxHighlighter.css" rel="stylesheet" type="text/css" />
</head>
<body>
<strong>This is an archive of blog posts from a "long time ago".  If you find this useful, let me know and I'll revive it.</strong>
    <div class="wrap">
        
        <div id="top group">
            <header>
                <h1>code blog foo - tag line bar</h1>
            </header>
            <div style="padding: 5px; border-bottom: 1px solid silver; border-top: 1px solid silver;">
                <nav>
                    <a href="/" style="margin-left: 15px; border-style: solid; border-width: 1px;">home</a>
                    <span class="sep"></span>
                    <a href="/Blog/Posts" style="margin-left: 15px; border-style: solid; border-width: 1px;">blog</a>
                    <a href="/Home/About" style="margin-left: 15px; border-style: solid; border-width: 1px;">about</a>
                    <a href="/Home/Portfolio" style="margin-left: 15px; border-style: solid; border-width: 1px;">projects/open source</a>
                </nav>
            </div>
        </div>
        
        <div class="content">
            
    
    
    <script type="text/javascript">
        window.onload = function () {
            SyntaxHighlighter.config.clipboardSwf = '/Scripts/clipboard.swf';
            SyntaxHighlighter.all();
            dp.SyntaxHighlighter.HighlightAll('code');
        };

     </script>
    <h2>Left Join on multiple tables in Linq to SQL</h2>

<p>
Wow really?  A blog post on Linq to SQL?  Yep...I still use it.  It's exactly what I need...a light-weight ORM.  Anyways, here's an example of a LEFT OUTER JOIN on multiple tables in Linq to SQL:
</p>
 
<pre name="code" class="c#">
from expense in expenseDataContext.ExpenseDtos
where expense.Id == expenseId //some expense id that was passed in
from category 
// left join on categories table if exists
in expenseDataContext.CategoryDtos
                     .Where(c =&gt; c.Id == expense.CategoryId)
                     .DefaultIfEmpty() 
// left join on expense type table if exists
from expenseType 
in expenseDataContext.ExpenseTypeDtos
                     .Where(e =&gt; e.Id == expense.ExpenseTypeId)
                     .DefaultIfEmpty()
// left join on currency table if exists
from currency 
in expenseDataContext.CurrencyDtos
                     .Where(c =&gt; c.CurrencyID == expense.FKCurrencyID)
                     .DefaultIfEmpty() 
select new 
{ 
    Expense = expense,
    // category will be null if join doesn't exist
    Category = category,
    // expensetype will be null if join doesn't exist
    ExpenseType = expenseType,
    // currency will be null if join doesn't exist
    Currency = currency  
} 
</pre>

<p>
<a target="_blank" href="http://stackoverflow.com/questions/267488/linq-to-sql-multiple-left-outer-joins">this StackOverflow question is helpful</a>
</p>
    <hr />
    <span style="color: Silver; font-size: small;">Written: 3/25/2010</span>
    
    <script>
        var idcomments_acct = '6ed8d3f7f3b269a55fc308e535627d11';
        var idcomments_post_url;

        var  idcomments_post_id;// = 'http%3A%2F%2Famirrajan.net%2FBlogs%2F' + 'left-join-on-multiple-tables-in-linq-to-sql';

    </script>
    <span id="IDCommentsPostTitle" style="display:none">Comments</span>
    <script type='text/javascript' src='http://www.intensedebate.com/js/genericCommentWrapperV2.js'></script>
    <script>$("#body").append('<div></div>').html(idcomments_post_id);</script>

        </div>
    </div>
</body>
</html>
